using Newtonsoft.Json.Linq;
using QLTS.Tool_Khao_Sat.Model;
using System;
using System.Collections.Generic;
using System.Data;
using System.IO;
using System.Linq;
using System.Net;
using System.Net.Http;
using System.Text;
using System.Text.Json;
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace QLTS.Tool_Khao_Sat.BL
{
    public class HttpApi
    {
        // public static string DataTenant = "{\"Status\":1,\"Data\":[{\"tenant_id\":\"02344d59-30c8-11ed-a9e0-005056b2173d\",\"tenant_code\":\"tuyenquang\",\"tenant_name\":\"Tỉnh Tuyên Quang\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"027ea72b-100f-11ed-a9e0-005056b2173d\",\"tenant_code\":\"tongcucthongke\",\"tenant_name\":\"Tổng cục thống kê\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"02953e77-0689-11ed-a9e0-005056b2173d\",\"tenant_code\":\"mpi\",\"tenant_name\":\"Bộ Kế hoạch và Đầu Tư\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"10807974-0689-11ed-a9e0-005056b2173d\",\"tenant_code\":\"soctrang\",\"tenant_name\":\"Tỉnh Sóc Trăng\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"11367a71-3a79-11ed-a9e0-005056b2173d\",\"tenant_code\":\"hoabinh\",\"tenant_name\":\"Tỉnh Hòa Bình\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"12a4835b-252d-11ed-a9e0-005056b2173d\",\"tenant_code\":\"cantho\",\"tenant_name\":\"Thành phố Cần Thơ\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"13810851-f60c-11ec-a9e0-005056b2173d\",\"tenant_code\":\"quangngai\",\"tenant_name\":\"Tỉnh Quảng Ngãi\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"16758f6a-25e4-11ed-a9e0-005056b2173d\",\"tenant_code\":\"travinh\",\"tenant_name\":\"Tỉnh Trà Vinh\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"167859f3-25e4-11ed-a9e0-005056b2173d\",\"tenant_code\":\"dongnai\",\"tenant_name\":\"Tỉnh Đồng Nai\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"1a12f068-25b3-11ed-a9e0-005056b2173d\",\"tenant_code\":\"hanam\",\"tenant_name\":\"Tỉnh Hà Nam\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"1c5f21ee-25b3-11ed-a9e0-005056b2173d\",\"tenant_code\":\"gialai\",\"tenant_name\":\"Tỉnh Gia Lai\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"2089eec9-33de-11ec-bc60-005056b2173d\",\"tenant_code\":\"daknong\",\"tenant_name\":\"Tỉnh Đắk Nông\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"2d6283be-f60c-11ec-a9e0-005056b2173d\",\"tenant_code\":\"quangninh\",\"tenant_name\":\"Tỉnh Quảng Ninh\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"2d6feb41-1012-11ed-a9e0-005056b2173d\",\"tenant_code\":\"angiang\",\"tenant_name\":\"Tỉnh An Giang\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"30afba67-3a87-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bariavungtau\",\"tenant_name\":\"Tỉnh Bà Rịa - Vũng Tàu\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"344443e1-254e-11ed-a9e0-005056b2173d\",\"tenant_code\":\"hagiang\",\"tenant_name\":\"Tỉnh Hà Giang\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"3534260f-1d52-11ed-a9e0-005056b2173d\",\"tenant_code\":\"phuyen\",\"tenant_name\":\"Tỉnh Phú Yên\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"3697caca-c92c-11ed-8e94-005056b2173d\",\"tenant_code\":\"mofa\",\"tenant_name\":\"Bộ Ngoại giao\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"377f002b-2465-11ed-a9e0-005056b2173d\",\"tenant_code\":\"haiphong\",\"tenant_name\":\"Thành phố Hải Phòng\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"3791baf8-2465-11ed-a9e0-005056b2173d\",\"tenant_code\":\"namdinh\",\"tenant_name\":\"Tỉnh Nam Định\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"37f33706-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"hvct\",\"tenant_name\":\"Học viện chính trị quốc gia Hồ Chí Minh (hvct)\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"37f5e91e-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"hvcthc\",\"tenant_name\":\"Học viện Chính trị - Hành chính Quốc gia Hồ Chí Minh\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"37f70a1c-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"boxaydung\",\"tenant_name\":\"Bộ Xây dựng\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"37f91b29-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"molisa\",\"tenant_name\":\"Bộ Lao động Thương binh và Xã hội\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"37fa6dab-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"twd\",\"tenant_name\":\"Trung ương Đảng\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"37fbbabe-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bovanhoa\",\"tenant_name\":\"Bộ Văn hóa, Thể thao và Du lịch\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"37fccc49-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"vass\",\"tenant_name\":\"Viện hàn lâm khoa học và công nghệ Việt Nam (vass)\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"37fdfa45-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"benhvienthongnhat\",\"tenant_name\":\"Bệnh Viện Thống Nhất\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"37ff3ddf-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"vnu\",\"tenant_name\":\"Đại học Quốc Gia Hà Nội\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"3800b8a8-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bokhoahoc\",\"tenant_name\":\"Bộ khoa học\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"3801f7ed-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bokhoahoccongnghe\",\"tenant_name\":\"Bộ khoa học và công nghệ\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"3803574b-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"phunuvietnam\",\"tenant_name\":\"Hội liên hiệp phụ nữ Việt Nam\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"380485e3-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"vast\",\"tenant_name\":\"Viện hàn lâm khoa học và công nghệ Việt Nam (vast)\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"3805d077-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"vpcp\",\"tenant_name\":\"Văn phòng Chính phủ\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"38071ee3-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bca\",\"tenant_name\":\"Bộ Công An\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"38083fdd-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"hvhc\",\"tenant_name\":\"Học viện Chính trị quốc gia Hồ Chí Minh (hvhc)\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"380e3926-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"vpqh\",\"tenant_name\":\"Quốc Hội Việt Nam\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"38105bf8-3c80-11ed-a9e0-005056b2173d\",\"tenant_code\":\"vcbs\",\"tenant_name\":\"Công ty TNHH Chứng khoán Ngân hàng TMCP Ngoại thương Việt Nam\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"3e7c595f-25df-11ed-a9e0-005056b2173d\",\"tenant_code\":\"dangcongsan\",\"tenant_name\":\"Đảng Cộng Sản\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"42f9b6b8-3ba6-11ed-a9e0-005056b2173d\",\"tenant_code\":\"thaibinh\",\"tenant_name\":\"Tỉnh Thái Bình\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"45bfa625-25df-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bonongnghiep\",\"tenant_name\":\"Bộ Nông Nghiệp\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"49403a8a-2675-11ed-a9e0-005056b2173d\",\"tenant_code\":\"baclieu\",\"tenant_name\":\"Tỉnh Bạc Liêu\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"4bc5c6f8-124a-11ed-a9e0-005056b2173d\",\"tenant_code\":\"vks\",\"tenant_name\":\"Viện kiểm sát\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"5118dda6-3032-11ed-a9e0-005056b2173d\",\"tenant_code\":\"daklak\",\"tenant_name\":\"Tỉnh Đắk Lắk\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"5740e598-25b1-11ed-a9e0-005056b2173d\",\"tenant_code\":\"phutho\",\"tenant_name\":\"Tỉnh Phú Thọ\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"5d1b1147-100c-11ed-a9e0-005056b2173d\",\"tenant_code\":\"kiemtoannhanuoc\",\"tenant_name\":\"Kiểm toán nhà nước\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"5d7734a1-1b08-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bonoivu\",\"tenant_name\":\"Bộ Nội vụ\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"5e9fb278-1c88-11ed-a9e0-005056b2173d\",\"tenant_code\":\"longan\",\"tenant_name\":\"Tỉnh Long An\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"60511429-3b53-11ed-a9e0-005056b2173d\",\"tenant_code\":\"backan\",\"tenant_name\":\"Tỉnh Bắc Kạn\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"66ef5b35-0fe9-11ed-a9e0-005056b2173d\",\"tenant_code\":\"thanhhoa\",\"tenant_name\":\"Tỉnh Thanh Hóa\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"679b0054-100f-11ed-a9e0-005056b2173d\",\"tenant_code\":\"binhthuan\",\"tenant_name\":\"Tỉnh Bình Thuận\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"6cdbd137-f3ad-11ec-a9e0-005056b2173d\",\"tenant_code\":\"dongthap\",\"tenant_name\":\"Tỉnh Đồng Tháp\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"7291019c-1012-11ed-a9e0-005056b2173d\",\"tenant_code\":\"haiduong\",\"tenant_name\":\"Tỉnh Hải Dương\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"729efc7b-3a77-11ed-a9e0-005056b2173d\",\"tenant_code\":\"hungyen\",\"tenant_name\":\"Tỉnh Hưng Yên\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"74db6a90-305d-11ed-a9e0-005056b2173d\",\"tenant_code\":\"caobang\",\"tenant_name\":\"Tỉnh Cao Bằng\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"750b10e5-305d-11ed-a9e0-005056b2173d\",\"tenant_code\":\"thainguyen\",\"tenant_name\":\"Tỉnh Thái Nguyên\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"750cbc8b-305d-11ed-a9e0-005056b2173d\",\"tenant_code\":\"vinhlong\",\"tenant_name\":\"Tỉnh Vĩnh Long\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"750e47d8-305d-11ed-a9e0-005056b2173d\",\"tenant_code\":\"langson\",\"tenant_name\":\"Tỉnh Lạng Sơn\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"7f5401b0-25dd-11ed-a9e0-005056b2173d\",\"tenant_code\":\"botuphap\",\"tenant_name\":\"Bộ Tư Pháp\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"81dfc24a-25a8-11ed-a9e0-005056b2173d\",\"tenant_code\":\"danang\",\"tenant_name\":\"Thành phố Đà Nẵng\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"875b4c92-3b39-11ed-a9e0-005056b2173d\",\"tenant_code\":\"quangbinh\",\"tenant_name\":\"Tỉnh Quảng Bình\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"8accd51b-1b24-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bocongthuong\",\"tenant_name\":\"Bộ Công Thương\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"8d186111-1011-11ed-a9e0-005056b2173d\",\"tenant_code\":\"tiengiang\",\"tenant_name\":\"Tỉnh Tiền Giang\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"909a9e6c-1b22-11ed-a9e0-005056b2173d\",\"tenant_code\":\"boyte\",\"tenant_name\":\"Bộ Y tế\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"91038f66-7778-11ed-8e94-005056b2173d\",\"tenant_code\":\"register\",\"tenant_name\":\"register\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"9a1fd412-a81d-11ed-8e94-005056b2173d\",\"tenant_code\":\"mic\",\"tenant_name\":\"Bộ Thông tin và Truyền thông\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"9eda0fa6-302c-11ed-a9e0-005056b2173d\",\"tenant_code\":\"hatinh\",\"tenant_name\":\"Tỉnh Hà Tĩnh\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"9f8479df-1012-11ed-a9e0-005056b2173d\",\"tenant_code\":\"lamdong\",\"tenant_name\":\"Tỉnh Lâm Đồng\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"a6aebfc5-3bd5-11ed-a9e0-005056b2173d\",\"tenant_code\":\"dienbien\",\"tenant_name\":\"Tỉnh Điện Biên\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"a6dae614-3bf2-11ed-a9e0-005056b2173d\",\"tenant_code\":\"hcm\",\"tenant_name\":\"TP Hồ Chí Minh\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"a769e88c-2541-11ed-a9e0-005056b2173d\",\"tenant_code\":\"nghean\",\"tenant_name\":\"Tỉnh Nghệ An\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"aa0f74e8-a861-11ed-8e94-005056b2173d\",\"tenant_code\":\"laichau\",\"tenant_name\":\"Tỉnh Lai Châu\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"ad04d936-2371-11ec-867c-005056b2173d\",\"tenant_code\":\"thidiem\",\"tenant_name\":\"Thí điểm\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"ad104ed2-40dd-11ed-a9e0-005056b2173d\",\"tenant_code\":\"hanoi\",\"tenant_name\":\"Thành phố Hà Nội\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"b18b6a50-1b1f-11ed-a9e0-005056b2173d\",\"tenant_code\":\"vov\",\"tenant_name\":\"Đài Tiếng nói Việt Nam\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"b781230e-b80f-11ed-9d8e-005056b2db83\",\"tenant_code\":\"bodemov2\",\"tenant_name\":\"Bộ DEMO\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"bfaa5aa7-c6d1-11ed-8e94-005056b2173d\",\"tenant_code\":\"thidiem1\",\"tenant_name\":\"Thí điểm 1\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"c39bf8c9-f238-11ec-a9e0-005056b2173d\",\"tenant_code\":\"demo\",\"tenant_name\":\"Tỉnh DEMO\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"c4bd0f8d-2671-11ed-a9e0-005056b2173d\",\"tenant_code\":\"kiengiang\",\"tenant_name\":\"Tỉnh Kiên Giang\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"c7764476-0370-11ee-bde7-005056b2173d\",\"tenant_code\":\"misatestperformance\",\"tenant_name\":\"MISA Test Performance\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"ccafe0dd-1b26-11ed-a9e0-005056b2173d\",\"tenant_code\":\"laocai\",\"tenant_name\":\"Tỉnh Lào Cai\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"cf52ff31-ebce-11ec-a9e0-005056b2173d\",\"tenant_code\":\"haugiang\",\"tenant_name\":\"Tỉnh Hậu Giang\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"d2631468-2676-11ed-a9e0-005056b2173d\",\"tenant_code\":\"khanhhoa\",\"tenant_name\":\"Tỉnh Khánh Hòa\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"d3bf68bc-1ae0-11ed-a9e0-005056b2173d\",\"tenant_code\":\"vinhphuc\",\"tenant_name\":\"Tỉnh Vĩnh Phúc\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"d8987da1-1b67-11ed-a9e0-005056b2173d\",\"tenant_code\":\"quangtri\",\"tenant_name\":\"Tỉnh Quảng Trị\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"da1d8128-916e-11ed-9e30-005056b359ee\",\"tenant_code\":\"qlts_authentication\",\"tenant_name\":\"qlts_authentication\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"db792f1e-1706-11ed-a9e0-005056b2173d\",\"tenant_code\":\"yenbai\",\"tenant_name\":\"Tỉnh Yên Bái\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"dd1cd603-01d4-11ed-a9e0-005056b2173d\",\"tenant_code\":\"camau\",\"tenant_name\":\"Tỉnh Cà Mau\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"dfba5393-3059-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bogiaothong\",\"tenant_name\":\"Bộ giao thông vận tải\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"dfbc6ed7-3059-11ed-a9e0-005056b2173d\",\"tenant_code\":\"hue\",\"tenant_name\":\"Tỉnh Thừa Thiên Huế\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"dfbdf6f8-3059-11ed-a9e0-005056b2173d\",\"tenant_code\":\"ninhthuan\",\"tenant_name\":\"Tỉnh Ninh Thuận\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"e001848f-0688-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bacgiang\",\"tenant_name\":\"Tỉnh Bắc Giang\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"e0a49238-3b5a-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bacninh\",\"tenant_name\":\"Tỉnh Bắc Ninh\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"e1740619-3c00-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bogiaoducvadaotao\",\"tenant_name\":\"Bộ giáo dục và đào tạo\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"e286bfc8-3039-11ed-a9e0-005056b2173d\",\"tenant_code\":\"ninhbinh\",\"tenant_name\":\"Tỉnh Ninh Bình\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"e71a1845-3039-11ed-a9e0-005056b2173d\",\"tenant_code\":\"binhduong\",\"tenant_name\":\"Tỉnh Bình Dương\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"e9e0c8a1-3039-11ed-a9e0-005056b2173d\",\"tenant_code\":\"toaan\",\"tenant_name\":\"Tòa án Nhân dân Tối cao\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"eb64ef4b-1b6c-11ed-a9e0-005056b2173d\",\"tenant_code\":\"sonla\",\"tenant_name\":\"Tỉnh Sơn La\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"eb67bc4a-1b6c-11ed-a9e0-005056b2173d\",\"tenant_code\":\"binhphuoc\",\"tenant_name\":\"Tỉnh Bình Phước\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"eb6d03f9-1b6c-11ed-a9e0-005056b2173d\",\"tenant_code\":\"tayninh\",\"tenant_name\":\"Tỉnh Tây Ninh\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"eb7019be-1b6c-11ed-a9e0-005056b2173d\",\"tenant_code\":\"bentre\",\"tenant_name\":\"Tỉnh Bến Tre\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"f1e33782-1ee5-11ed-a9e0-005056b2173d\",\"tenant_code\":\"binhdinh\",\"tenant_name\":\"Tỉnh Bình Định\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"f443f888-6cae-11ed-8e94-005056b2173d\",\"tenant_code\":\"kontum\",\"tenant_name\":\"Tỉnh KonTum\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"fa62b7e4-2c5f-11ee-bde7-005056b2173d\",\"tenant_code\":\"thidiem2\",\"tenant_name\":\"Thí điểm 2\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0},{\"tenant_id\":\"faf05d3c-1011-11ed-a9e0-005056b2173d\",\"tenant_code\":\"quangnam\",\"tenant_name\":\"Tỉnh Quảng Nam\",\"version\":null,\"using_misaId\":false,\"service_type\":0,\"port_name\":0,\"database_name\":null,\"server_name\":null,\"user_name\":null,\"password\":null,\"microservice_type\":0,\"database_action\":0,\"created_by\":null,\"created_date\":null,\"modified_by\":null,\"modified_date\":null,\"WorkBookData\":null,\"MISAEntityState\":0}],\"Message\":null,\"Code\":null}";
        // public static string DataSurvey = "{\"Status\":1,\"Data\":[{\"Total\":5}],\"Message\":null,\"Code\":null}";

        // Cookie để gọi api
        public string CookieValue = string.Empty;

        public async Task<List<Tenant>> GetTeants()
        {
            List<Tenant> tenants = new List<Tenant>();

            string host = "https://registerqltsv2.misaonline.vpnlocal/";
            string endpoint = "/misa/qltsregister/licenses/getunitdata?page=0&size=-1";

            HttpClient httpClient;
            CookieContainer cookie = new CookieContainer();
            HttpClientHandler handler = new HttpClientHandler
            {
                CookieContainer = cookie,
                ClientCertificateOptions = ClientCertificateOption.Automatic,
                AutomaticDecompression = DecompressionMethods.GZip | DecompressionMethods.Deflate,
                AllowAutoRedirect = true,
                UseDefaultCredentials = false
            };

            httpClient = new HttpClient(handler);
            httpClient.BaseAddress = new Uri(host);

            cookie.Add(new Cookie("x-qsessionid", CookieValue) { Domain = httpClient.BaseAddress.Host });

            //Thread.Sleep(300);
            var result = await httpClient.GetAsync(endpoint);

            string resultContent = await result.Content.ReadAsStringAsync();
            //string resultContent = DataTenant;

            var response = JsonSerializer.Deserialize<TenantResponse>(resultContent, new JsonSerializerOptions { PropertyNameCaseInsensitive = true });

            tenants = response.Data;

            return tenants;
        }

        public async Task<int> GetTotalSurvey(string tenant_id, string query)
        {
            var result = 0;

            try
            {
                //Thread.Sleep(300);
                var resultContent = await PostApi(tenant_id, query);
                //var resultContent = DataSurvey;

                var response = JsonSerializer.Deserialize<TotalResponse>(resultContent, new JsonSerializerOptions { PropertyNameCaseInsensitive = true });

                result = response.Data.FirstOrDefault().Total;
            }
            catch (Exception ex)
            {
            }

            //return (new Random()).Next(1,100);
            return result;
        }

        public async Task<List<DataV2>> ExecuteScript(string tenant_id, string query)
        {
            var result = new List<DataV2>();

            var resultContent = await PostApi(tenant_id, query);

            var response = JsonSerializer.Deserialize<ExecuteResponseV2>(resultContent, new JsonSerializerOptions { PropertyNameCaseInsensitive = true });

            if(response.Status == 0)
            {
                throw new Exception("Có lỗi xảy ra");
            }

            if (response.Data.Count > 0)
            {
                result = response.Data;
            }

            return result;
        }

        public async Task<object> ExecuteScriptJson(string tenant_id, string query)
        {
            var resultContent = await PostApi(tenant_id, query);

            var response = JsonSerializer.Deserialize<ExecuteResponseJson>(resultContent, new JsonSerializerOptions { PropertyNameCaseInsensitive = true });

            if (response.Status == 0)
            {
                throw new Exception("Có lỗi xảy ra");
            }

            return response.Data;
        }

        public DataTable ConvertJsonToDataTable(string jsonString)
        {
            // Tạo DataTable mới
            DataTable dataTable = new DataTable();

            // Chuyển đổi chuỗi JSON thành đối tượng JArray
            JArray jsonArray = JArray.Parse(jsonString);

            // Lấy các tên cột từ đối tượng đầu tiên trong mảng JSON
            foreach (JToken token in jsonArray[0])
            {
                dataTable.Columns.Add(token.Path.Replace("[0].",""), typeof(string));
            }

            try
            {
                // Thêm dữ liệu từ mảng JSON vào DataTable
                foreach (JObject jsonObject in jsonArray)
                {
                    DataRow row = dataTable.NewRow();

                    foreach (JProperty property in jsonObject.Properties())
                    {
                        row[property.Name] = property.Value.ToString();
                    }

                    dataTable.Rows.Add(row);
                }
            }
            catch (Exception ex)
            {
            }

            return dataTable;
        }

        // Thực hiện api post dữ liệu
        public async Task<string> PostApi(string tenant_id, string query)
        {
            string host = "https://registerqltsv2.misaonline.vpnlocal/";
            string endpoint = "/organizationmanagement/executescript";

            HttpClient httpClient;
            CookieContainer cookie = new CookieContainer();
            HttpClientHandler handler = new HttpClientHandler
            {
                CookieContainer = cookie,
                ClientCertificateOptions = ClientCertificateOption.Automatic,
                AutomaticDecompression = DecompressionMethods.GZip | DecompressionMethods.Deflate,
                AllowAutoRedirect = true,
                UseDefaultCredentials = false
            };

            httpClient = new HttpClient(handler);
            httpClient.BaseAddress = new Uri(host);

            cookie.Add(new Cookie("x-qsessionid", CookieValue) { Domain = httpClient.BaseAddress.Host });

            var param = new { tenant_id, query };

            var result = await httpClient.PostAsync(endpoint, new StringContent(JsonSerializer.Serialize(param), Encoding.UTF8, "application/json"));

            return await result.Content.ReadAsStringAsync();
        }

        // Load danh sách json các vấn đề
        public List<Subject> LoadSubjectJson()
        {
            List<Subject> subjects = new List<Subject>();

            try
            {
                using (StreamReader r = new StreamReader(Application.StartupPath + "/Data/Subjects.json"))
                {
                    string json = r.ReadToEnd();

                    var subjectJson = JsonSerializer.Deserialize<SubjectJson>(json, new JsonSerializerOptions { PropertyNameCaseInsensitive = true });

                    subjects = subjectJson.Data;
                }
            }
            catch (Exception ex)
            {
            }

            return subjects;
        }

        public void WriteLog(string log, string pathLog)
        {
            try
            {
                StreamWriter sw = new StreamWriter(pathLog, true);

                sw.Write(log);
                sw.Close();
            }
            catch
            {
            }
        }

        public void SaveCookieJson(string cookie)
        {
            CookieJson cookieObj = new CookieJson();
            cookieObj.Cookie = cookie;

            string json = JsonSerializer.Serialize(cookieObj, new JsonSerializerOptions { PropertyNameCaseInsensitive = true });

            File.WriteAllText(Application.StartupPath + "/Data/Cookie.json", json);
        }

        public CookieJson LoadCookieJson()
        {
            CookieJson result = new CookieJson();

            try
            {
                using (StreamReader r = new StreamReader(Application.StartupPath + "/Data/Cookie.json"))
                {
                    string json = r.ReadToEnd();

                    result = JsonSerializer.Deserialize<CookieJson>(json, new JsonSerializerOptions { PropertyNameCaseInsensitive = true });
                }
            }
            catch (Exception ex)
            {
            }

            return result;
        }
    }
}
